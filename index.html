<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Catalog</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background-color: #121212; color: #fff; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; background: #1e1e1e; padding: 15px; border-radius: 5px; }
        .search-bar { width: 50%; padding: 8px; border: none; border-radius: 5px; font-size: 16px; }
        .filter-sort { display: flex; gap: 10px; }
        .btn { padding: 8px 12px; cursor: pointer; background: #333; color: #fff; border: none; border-radius: 5px; }
        .btn:hover { background: #555; }
        .content { display: flex; gap: 20px; margin-top: 20px; }
        .movie-list { flex: 3; background: #1e1e1e; padding: 15px; border-radius: 5px; }
        .watchlist { flex: 1; background: #292929; padding: 15px; border-radius: 5px; }
        .folder, .movie, .watchlist-item { padding: 10px; border-bottom: 1px solid #444; display: flex; justify-content: space-between; align-items: center; }
        .folder:hover, .movie:hover, .watchlist-item:hover { background: #2a2a2a; }
        .add-btn, .remove-btn { cursor: pointer; color: #ffcc00; font-weight: bold; }
        .remove-btn { color: red; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- 🔍 HEADER -->
    <div class="header">
        <input type="text" class="search-bar" placeholder="🔍 Search movies or folders..." onkeyup="filterMovies()">
        <div class="filter-sort">
            <button class="btn" onclick="showAll()">🎞️ All</button>
            <button class="btn" onclick="showFolders()">📁 Folders</button>
            <button class="btn" onclick="showMovies()">🎬 Movies</button>
            <button class="btn" onclick="sortMovies('name')">A → Z</button>
            <button class="btn" onclick="sortMovies('name', true)">Z → A</button>
            <button class="btn" onclick="sortMovies('modified_date', true)">Last Modified</button>
            <button class="btn" onclick="sortMovies('size', true)">File Size</button>
        </div>
    </div>

    <!-- 📜 CONTENT -->
    <div class="content">
        <!-- 📂 MOVIE LIST -->
        <div class="movie-list">
            <h3>🎞️ Movie Library</h3>
            <div id="movies-container"></div>
        </div>

        <!-- 📜 WATCHLIST -->
        <div class="watchlist">
            <h3>✅ Watchlist</h3>
            <div id="watchlist-container"></div>
        </div>
    </div>

    <script>
        let moviesData = [];
        let watchlist = JSON.parse(localStorage.getItem("watchlist")) || [];

        // 📜 LOAD MOVIES FROM JSON
        async function loadMovies() {
            try {
                const response = await fetch("movies.json");
                const data = await response.json();
                moviesData = data.movies;
                displayMovies();
                displayWatchlist();
            } catch (error) {
                console.error("Error loading movies:", error);
            }
        }

        // 🎬 DISPLAY MOVIES & FOLDERS
        function displayMovies(filterType = "all") {
            const container = document.getElementById("movies-container");
            container.innerHTML = "";
            let filteredMovies = moviesData;

            if (filterType === "movies") {
                filteredMovies = moviesData.filter(m => !m.name.toLowerCase().includes("folder"));
            } else if (filterType === "folders") {
                filteredMovies = moviesData.filter(m => m.name.toLowerCase().includes("folder"));
            }

            filteredMovies.forEach(movie => {
                const div = document.createElement("div");
                div.classList.add(movie.name.includes("folder") ? "folder" : "movie");

                div.innerHTML = `
                    ${movie.name} (${(movie.size / 1e9).toFixed(1)}GB) | 📅 ${movie.modified_date}
                    <span class="add-btn" onclick="addToWatchlist('${movie.name}')">➕ [Watchlist]</span>
                `;
                container.appendChild(div);
            });
        }

        // ✅ DISPLAY WATCHLIST
        function displayWatchlist() {
            const container = document.getElementById("watchlist-container");
            container.innerHTML = "";
            watchlist.forEach((item, index) => {
                const div = document.createElement("div");
                div.classList.add("watchlist-item");
                div.innerHTML = `
                    ✅ ${item}
                    <span class="remove-btn" onclick="removeFromWatchlist(${index})">🗑️ [Remove]</span>
                `;
                container.appendChild(div);
            });
        }

        // 🔍 FILTER MOVIES
        function filterMovies() {
            const query = document.querySelector(".search-bar").value.toLowerCase();
            document.querySelectorAll(".movie, .folder").forEach(item => {
                item.style.display = item.innerText.toLowerCase().includes(query) ? "" : "none";
            });
        }

        // 📂 FILTER VIEW
        function showAll() { displayMovies("all"); }
        function showFolders() { displayMovies("folders"); }
        function showMovies() { displayMovies("movies"); }

        // 🔽 SORT MOVIES
        function sortMovies(type, descending = false) {
            moviesData.sort((a, b) => {
                let valA = a[type], valB = b[type];
                if (type === "size") { valA = Number(valA); valB = Number(valB); }
                if (type === "modified_date") { valA = new Date(valA); valB = new Date(valB); }
                return descending ? valB - valA : valA - valB;
            });
            displayMovies();
        }

        // ➕ ADD TO WATCHLIST
        function addToWatchlist(name) {
            if (!watchlist.includes(name)) {
                watchlist.push(name);
                localStorage.setItem("watchlist", JSON.stringify(watchlist));
                displayWatchlist();
            }
        }

        // 🗑️ REMOVE FROM WATCHLIST
        function removeFromWatchlist(index) {
            watchlist.splice(index, 1);
            localStorage.setItem("watchlist", JSON.stringify(watchlist));
            displayWatchlist();
        }

        // 🔄 INITIATE
        loadMovies();
    </script>
</body>
</html>
