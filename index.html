<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Catalog Pro</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #ff4757;
            --secondary: #ff6b81;
            --background: #f5f6fa;
            --surface: #ffffff;
            --text: #2f3542;
            --border: #dfe4ea;
            --highlight: #ff9f43;
            --success: #2ed573;
            --transition: all 0.3s ease-in-out;
        }

        [data-theme="dark"] {
            --background: #1e272e;
            --surface: #485460;
            --text: #f1f2f6;
            --border: #808e9b;
            --highlight: #ff9f43;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background: var(--background);
            color: var(--text);
            transition: var(--transition);
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            background: var(--surface);
            width: 250px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            border-right: 2px solid var(--border);
            transition: var(--transition);
        }

        .brand {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            gap: 12px;
        }

        .sidebar nav {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .nav-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
        }

        .nav-item:hover {
            background: var(--highlight);
            color: white;
        }

        .main-content {
            flex: 1;
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--surface);
            padding: 0.75rem;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        #search {
            flex: 1;
            border: none;
            background: transparent;
            color: var(--text);
            font-size: 1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .card {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 16px;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            border: 2px solid var(--border);
        }

        .card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .save-btn {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: var(--highlight);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }

        .save-btn:hover {
            background: var(--success);
        }

        .theme-toggle {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--surface);
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 2px solid var(--border);
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                ðŸŽ¬ Movie Pro
            </div>
            <nav>
                <div class="nav-item">ðŸ“Œ Your Watchlist <span id="watchlistCount">(0)</span></div>
            </nav>
        </aside>
        
        <main class="main-content">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search" placeholder="Search movies...">
            </div>
            <div class="grid" id="results"></div>
        </main>
    </div>
    
    <button class="theme-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </button>
<script>document.addEventListener("DOMContentLoaded", () => {
    let allItems = [];
    let watchlist = JSON.parse(localStorage.getItem("watchlist")) || [];
    const resultsContainer = document.getElementById("results");
    const watchlistContainer = document.getElementById("watchlistContainer");
    const watchlistBtn = document.getElementById("watchlistBtn");
    const watchlistCount = document.getElementById("watchlistCount");
    const searchInput = document.getElementById("search");
    const darkModeToggle = document.getElementById("darkModeToggle");

    // Load movie data
    async function loadData() {
        try {
            const response = await fetch("movies.json");
            if (!response.ok) throw new Error("Failed to load data");
            
            const data = await response.json();
            allItems = flattenData(data.root);
            displayResults(allItems.slice(0, 50)); // Lazy load first 50 items
            updateWatchlistCount();
        } catch (error) {
            console.error(error);
        }
    }

    // Flatten folder structure
    function flattenData(root) {
        return root.reduce((acc, item) => {
            if (item.movies) acc.push(...item.movies);
            return acc;
        }, []);
    }

    // Display movie results
    function displayResults(items) {
        resultsContainer.innerHTML = "";
        items.forEach(movie => {
            const card = document.createElement("div");
            card.classList.add("card");
            card.innerHTML = `
                <h3>${movie.title}</h3>
                <button class="save-btn ${watchlist.includes(movie.title) ? 'saved' : ''}" data-title="${movie.title}">
                    ${watchlist.includes(movie.title) ? 'âœ” Saved' : 'ðŸ’¾ Save'}
                </button>
            `;
            resultsContainer.appendChild(card);
        });
        attachSaveListeners();
    }

    // Save to watchlist
    function attachSaveListeners() {
        document.querySelectorAll(".save-btn").forEach(btn => {
            btn.addEventListener("click", (e) => {
                const title = e.target.getAttribute("data-title");
                if (watchlist.includes(title)) {
                    watchlist = watchlist.filter(item => item !== title);
                } else {
                    watchlist.push(title);
                }
                localStorage.setItem("watchlist", JSON.stringify(watchlist));
                updateWatchlist();
                displayResults(allItems.slice(0, 50));
            });
        });
    }

    // Update watchlist UI
    function updateWatchlist() {
        watchlistContainer.innerHTML = watchlist.map(title => `<li>${title}</li>`).join(" ");
        updateWatchlistCount();
    }

    function updateWatchlistCount() {
        watchlistCount.textContent = `${watchlist.length} Saved`;
    }

    // Search functionality
    searchInput.addEventListener("input", (e) => {
        const query = e.target.value.toLowerCase();
        const filtered = allItems.filter(movie => movie.title.toLowerCase().includes(query));
        displayResults(filtered);
    });

    // Dark mode toggle
    darkModeToggle.addEventListener("click", () => {
        document.body.dataset.theme = document.body.dataset.theme === "dark" ? "light" : "dark";
    });

    loadData();
});
</script>
</body>
</html>
